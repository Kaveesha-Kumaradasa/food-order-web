import{C as S,D as O,E as w,F as p,H as s,I as R,K as _,L as C,M,T as E,W as J,_ as K,a as G,aa as N,b as H,ba as I,ca as B,da as Q,fa as V,ga as L,h as v,ha as T,i as P,ia as W,ja as q,k as b,ka as F,la as k,n as u,o as f,oa as A,pa as X,q as l,qa as Y,r as h,ra as Z,s as y,sa as $,t as x,ta as ee,u as g,w as c,x as r,y as n}from"./chunk-WYDC7NTN.js";function le(e,a){if(e&1&&(r(0,"p",11),s(1),n()),e&2){let t=w();l(),R(t.errorMessage)}}var D=class e{constructor(a,t,i){this.authService=a;this.router=t;this.route=i}email="";password="";errorMessage=null;loading=!1;returnUrl="/home";ngOnInit(){let a=this.route.snapshot.queryParamMap;this.returnUrl=a.get("returnUrl")||"/home"}onSubmit(a){if(a.invalid){this.errorMessage="Please fill all required fields.";return}let t=this.email.trim(),i=this.password;if(!t||!i){this.errorMessage="Please fill all required fields.";return}this.errorMessage=null,this.loading=!0,this.authService.login(t,i).pipe(v(1),P(()=>this.loading=!1)).subscribe({next:m=>{this.errorMessage=null,this.router.navigateByUrl(this.returnUrl)},error:m=>{let d=(m?.message||"").toLowerCase();d.includes("user account does not exist")?this.errorMessage="We couldn\u2019t find an account with those details.":d.includes("invalid")||d.includes("credentials")?this.errorMessage="Invalid credentials. Please try again.":this.errorMessage=m?.message||"Login failed.",this.password=""}})}static \u0275fac=function(t){return new(t||e)(h(V),h(N),h(K))};static \u0275cmp=y({type:e,selectors:[["app-login"]],standalone:!1,decls:20,vars:3,consts:[["loginForm","ngForm"],[1,"login-container"],[3,"ngSubmit"],[1,"form-group"],["for","email"],["type","email","id","email","name","email","required","",3,"ngModelChange","ngModel"],["for","password"],["type","password","id","password","name","password","required","",3,"ngModelChange","ngModel"],["type","submit"],["class","error",4,"ngIf"],["routerLink","/auth/register"],[1,"error"]],template:function(t,i){if(t&1){let m=S();r(0,"div",1)(1,"h2"),s(2,"Login"),n(),r(3,"form",2,0),O("ngSubmit",function(){u(m);let o=p(4);return f(i.onSubmit(o))}),r(5,"div",3)(6,"label",4),s(7,"Email"),n(),r(8,"input",5),M("ngModelChange",function(o){return u(m),C(i.email,o)||(i.email=o),f(o)}),n()(),r(9,"div",3)(10,"label",6),s(11,"Password"),n(),r(12,"input",7),M("ngModelChange",function(o){return u(m),C(i.password,o)||(i.password=o),f(o)}),n()(),r(13,"button",8),s(14,"Login"),n(),g(15,le,2,1,"p",9),n(),r(16,"p"),s(17,"Don't have an account? "),r(18,"a",10),s(19,"Register here"),n()()()}t&2&&(l(8),_("ngModel",i.email),l(4),_("ngModel",i.password),l(3),c("ngIf",i.errorMessage))},dependencies:[E,I,k,L,T,W,A,F,q],styles:[".login-container[_ngcontent-%COMP%]{max-width:400px;margin:50px auto;padding:20px;border:1px solid #ddd;border-radius:5px;background-color:#f9f9f9}.login-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.login-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:15px}.login-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px}.login-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ddd;border-radius:4px}.login-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;padding:10px;background-color:#4caf50;color:#fff;border:none;border-radius:4px;cursor:pointer}.login-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#45a049}.login-container[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:red;text-align:center;margin-top:10px}.login-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;margin-top:10px}.login-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#2196f3;text-decoration:underline;cursor:pointer}.login-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#1976d2}"]})};function me(e,a){e&1&&(r(0,"small"),s(1,"Email is required."),n())}function de(e,a){e&1&&(r(0,"small"),s(1,"Please enter a valid email."),n())}function ce(e,a){if(e&1&&(r(0,"div",20),g(1,me,2,0,"small",21)(2,de,2,0,"small",21),n()),e&2){w();let t=p(9);l(),c("ngIf",t.errors==null?null:t.errors.required),l(),c("ngIf",t.errors==null?null:t.errors.email)}}function ge(e,a){e&1&&(r(0,"small"),s(1,"Contact number is required."),n())}function pe(e,a){e&1&&(r(0,"small"),s(1,"Use digits only (7\u201315)."),n())}function ue(e,a){if(e&1&&(r(0,"div",20),g(1,ge,2,0,"small",21)(2,pe,2,0,"small",21),n()),e&2){w();let t=p(15);l(),c("ngIf",t.errors==null?null:t.errors.required),l(),c("ngIf",t.errors==null?null:t.errors.pattern)}}function fe(e,a){e&1&&(r(0,"small"),s(1,"Password is required."),n())}function _e(e,a){e&1&&(r(0,"small"),s(1,"Minimum 6 characters."),n())}function Ce(e,a){if(e&1&&(r(0,"div",20),g(1,fe,2,0,"small",21)(2,_e,2,0,"small",21),n()),e&2){w();let t=p(21);l(),c("ngIf",t.errors==null?null:t.errors.required),l(),c("ngIf",t.errors==null?null:t.errors.minlength)}}function Me(e,a){e&1&&(r(0,"div",20)(1,"small"),s(2,"Passwords do not match."),n()())}function he(e,a){if(e&1&&(r(0,"p",22),s(1),n()),e&2){let t=w();l(),R(t.errorMessage)}}var U=class e{constructor(a,t){this.authService=a;this.router=t}email="";contactNumber="";password="";confirmPassword="";submitted=!1;loading=!1;errorMessage=null;passwordsMatch(){return!!this.password&&!!this.confirmPassword&&this.password===this.confirmPassword}onSubmit(a){if(this.submitted=!0,this.errorMessage=null,a.invalid){this.errorMessage="Please fix the highlighted fields.";return}if(!this.passwordsMatch()){this.errorMessage="Passwords do not match.";return}let t={email:this.email.trim().toLowerCase(),password:this.password,password_confirmation:this.confirmPassword,first_name:"Demo",last_name:"Demo",country_code:Q.default_country_code,contact_number:this.contactNumber.trim().replace(/\D+/g,"")},i=H(G({},t),{password:"******",password_confirmation:"******"});console.debug("Register Sending payload:",i),this.loading=!0,this.authService.register(t).pipe(v(1),P(()=>this.loading=!1)).subscribe({next:m=>{console.info("Register Success:",m),this.router.navigate(["/home"])},error:m=>{console.error("Register Error:",m),this.errorMessage=m?.message||"Registration failed. Please check your details."}})}static \u0275fac=function(t){return new(t||e)(h(V),h(N))};static \u0275cmp=y({type:e,selectors:[["app-register"]],standalone:!1,decls:36,vars:9,consts:[["registerForm","ngForm"],["emailCtrl","ngModel"],["contactCtrl","ngModel"],["passwordCtrl","ngModel"],["confirmCtrl","ngModel"],[1,"register-container"],["novalidate","",3,"ngSubmit"],[1,"form-group"],["for","email"],["type","email","id","email","name","email","required","","email","",3,"ngModelChange","ngModel"],["class","field-error",4,"ngIf"],["for","contactNumber"],["type","tel","id","contactNumber","name","contactNumber","required","","pattern","^[0-9]{7,15}$","placeholder","e.g. 771234567",3,"ngModelChange","ngModel"],["for","password"],["type","password","id","password","name","password","required","","minlength","6",3,"ngModelChange","ngModel"],["for","confirmPassword"],["type","password","id","confirmPassword","name","confirmPassword","required","",3,"ngModelChange","ngModel"],["type","submit"],["class","error",4,"ngIf"],["routerLink","/auth/login"],[1,"field-error"],[4,"ngIf"],[1,"error"]],template:function(t,i){if(t&1){let m=S();r(0,"div",5)(1,"h2"),s(2,"Register"),n(),r(3,"form",6,0),O("ngSubmit",function(){u(m);let o=p(4);return f(i.onSubmit(o))}),r(5,"div",7)(6,"label",8),s(7,"Email"),n(),r(8,"input",9,1),M("ngModelChange",function(o){return u(m),C(i.email,o)||(i.email=o),f(o)}),n(),g(10,ce,3,2,"div",10),n(),r(11,"div",7)(12,"label",11),s(13,"Contact Number"),n(),r(14,"input",12,2),M("ngModelChange",function(o){return u(m),C(i.contactNumber,o)||(i.contactNumber=o),f(o)}),n(),g(16,ue,3,2,"div",10),n(),r(17,"div",7)(18,"label",13),s(19,"Password"),n(),r(20,"input",14,3),M("ngModelChange",function(o){return u(m),C(i.password,o)||(i.password=o),f(o)}),n(),g(22,Ce,3,2,"div",10),n(),r(23,"div",7)(24,"label",15),s(25,"Confirm Password"),n(),r(26,"input",16,4),M("ngModelChange",function(o){return u(m),C(i.confirmPassword,o)||(i.confirmPassword=o),f(o)}),n(),g(28,Me,3,0,"div",10),n(),r(29,"button",17),s(30,"Create Account"),n(),g(31,he,2,1,"p",18),n(),r(32,"p"),s(33,"Already have an account? "),r(34,"a",19),s(35,"Login here"),n()()()}if(t&2){let m=p(9),d=p(15),o=p(21),ne=p(27);l(8),_("ngModel",i.email),l(2),c("ngIf",(m.touched||i.submitted)&&m.invalid),l(4),_("ngModel",i.contactNumber),l(2),c("ngIf",(d.touched||i.submitted)&&d.invalid),l(4),_("ngModel",i.password),l(2),c("ngIf",(o.touched||i.submitted)&&o.invalid),l(4),_("ngModel",i.confirmPassword),l(2),c("ngIf",(ne.touched||i.submitted)&&i.password&&i.confirmPassword&&i.password!==i.confirmPassword),l(3),c("ngIf",i.errorMessage)}},dependencies:[E,I,k,L,T,W,A,Y,Z,X,F,q],styles:[".register-container[_ngcontent-%COMP%]{max-width:400px;margin:50px auto;padding:20px;border:1px solid #ddd;border-radius:5px;background-color:#fff3e0}.register-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.register-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:15px}.register-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px}.register-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ddd;border-radius:4px}.register-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;padding:10px;background-color:#4caf50;color:#fff;border:none;border-radius:4px;cursor:pointer}.register-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#45a049}.register-container[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:red;text-align:center;margin-top:10px}.register-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;margin-top:10px}.register-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#2196f3;text-decoration:underline;cursor:pointer}.register-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#1976d2}"]})};var we=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:D},{path:"register",component:U}],j=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=x({type:e});static \u0275inj=b({imports:[B.forChild(we),B]})};var te=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=x({type:e});static \u0275inj=b({imports:[J,j,ee,$]})};export{te as AuthModule};
